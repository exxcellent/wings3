YAHOO.util.Connect={_msxml_progid:["Microsoft.XMLHTTP","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"],_http_headers:{},_has_http_headers:!1,_use_default_post_header:!0,_default_post_header:"application/x-www-form-urlencoded; charset=UTF-8",_default_form_header:"application/x-www-form-urlencoded",_use_default_xhr_header:!0,_default_xhr_header:"XMLHttpRequest",_has_default_headers:!0,_default_headers:{},_isFormSubmit:!1,_isFileUpload:!1,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,_submitElementValue:null,_hasSubmitListener:(function(){if(YAHOO.util.Event){YAHOO.util.Event.addListener(document,"click",function(e){try{var $a=YAHOO.util.Event.getTarget(e);if($a.type.toLowerCase()=="submit"){YAHOO.util.Connect._submitElementValue=encodeURIComponent($a.name)+"="+encodeURIComponent($a.value);}}catch(e){}});return!0;}return!1;})(),startEvent:new YAHOO.util.CustomEvent("start"),completeEvent:new YAHOO.util.CustomEvent("complete"),successEvent:new YAHOO.util.CustomEvent("success"),failureEvent:new YAHOO.util.CustomEvent("failure"),uploadEvent:new YAHOO.util.CustomEvent("upload"),abortEvent:new YAHOO.util.CustomEvent("abort"),_customEvents:{onStart:["startEvent","start"],onComplete:["completeEvent","complete"],onSuccess:["successEvent","success"],onFailure:["failureEvent","failure"],onUpload:["uploadEvent","upload"],onAbort:["abortEvent","abort"]},setProgId:function(id){this._msxml_progid.unshift(id);},setDefaultPostHeader:function(b){if(typeof b=="string"){this._default_post_header=b;}else{if(typeof b=="boolean"){this._use_default_post_header=b;}}},setDefaultXhrHeader:function(b){if(typeof b=="string"){this._default_xhr_header=b;}else{this._use_default_xhr_header=b;}},setPollingInterval:function(i){if(typeof i=="number"&&isFinite(i)){this._polling_interval=i;}},createXhrObject:function($b){var $a,$c;try{$c=new XMLHttpRequest();$a={conn:$c,tId:$b};}catch(e){for(var i=0;i<this._msxml_progid.length;++i){try{$c=new ActiveXObject(this._msxml_progid[i]);$a={conn:$c,tId:$b};break;}catch(e){}}}finally{return $a;}},getConnectionObject:function($d){var o;var $e=this._transaction_id;try{if(!$d){o=this.createXhrObject($e);}else{o={};o.tId=$e;o.isUpload=!0;}if(o){this._transaction_id++;}}catch(e){}finally{return o;}},asyncRequest:function($f,$g,$h,$i){var o=(this._isFileUpload)?this.getConnectionObject(!0):this.getConnectionObject();if(!o){return null;}else{if($h&&$h.customevents){this.initCustomEvents(o,$h);}if(this._isFormSubmit){if(this._isFileUpload){this.uploadFile(o,$h,$g,$i);return o;}if($f.toUpperCase()=="GET"){if(this._sFormData.length!==0){$g+=(($g.indexOf("?")==-1)?"?":"&")+this._sFormData;}else{$g+="?"+this._sFormData;}}else{if($f.toUpperCase()=="POST"){$i=$i?this._sFormData+"&"+$i:this._sFormData;}}}o.conn.open($f,$g,!0);if(this._use_default_xhr_header){if(!this._default_headers["X-Requested-With"]){this.initHeader("X-Requested-With",this._default_xhr_header,!0);}}if(this._isFormSubmit||($i&&this._use_default_post_header)){this.initHeader("Content-Type",this._default_post_header);if(this._isFormSubmit){this.resetFormState();}}if(this._has_default_headers||this._has_http_headers){this.setHeader(o);}this.handleReadyState(o,$h);o.conn.send($i||null);this.startEvent.fire(o);if(o.startEvent){o.startEvent.fire(o);}return o;}},initCustomEvents:function(o,$h){for(var $j in $h.customevents){if(this._customEvents[$j][0]){o[this._customEvents[$j][0]]=new YAHOO.util.CustomEvent(this._customEvents[$j][1],($h.scope)?$h.scope:null);o[this._customEvents[$j][0]].subscribe($h.customevents[$j]);}}},handleReadyState:function(o,$h){var $k=this;if($h&&$h.timeout){this._timeOut[o.tId]=window.setTimeout(function(){$k.abort(o,$h,!0);},$h.timeout);}this._poll[o.tId]=window.setInterval(function(){if(o.conn&&o.conn.readyState===4){window.clearInterval($k._poll[o.tId]);delete $k._poll[o.tId];if($h&&$h.timeout){window.clearTimeout($k._timeOut[o.tId]);delete $k._timeOut[o.tId];}$k.completeEvent.fire(o);if(o.completeEvent){o.completeEvent.fire(o);}$k.handleTransactionResponse(o,$h);}},this._polling_interval);},handleTransactionResponse:function(o,$h,$l){var $m,$n;try{if(o.conn.status!==undefined&&o.conn.status!==0){$m=o.conn.status;}else{$m=13030;}}catch(e){$m=13030;}if($m>=200&&$m<300||$m===1223){$n=this.createResponseObject(o,($h&&$h.argument)?$h.argument:undefined);if($h){if($h.success){if(!$h.scope){$h.success($n);}else{$h.success.apply($h.scope,[$n]);}}}this.successEvent.fire($n);if(o.successEvent){o.successEvent.fire($n);}}else{switch($m){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:$n=this.createExceptionObject(o.tId,($h&&$h.argument)?$h.argument:undefined,($l?$l:!1));if($h){if($h.failure){if(!$h.scope){$h.failure($n);}else{$h.failure.apply($h.scope,[$n]);}}}break;default:$n=this.createResponseObject(o,($h&&$h.argument)?$h.argument:undefined);if($h){if($h.failure){if(!$h.scope){$h.failure($n);}else{$h.failure.apply($h.scope,[$n]);}}}}this.failureEvent.fire($n);if(o.failureEvent){o.failureEvent.fire($n);}}this.releaseObject(o);$n=null;},createResponseObject:function(o,$o){var $a={};var $p={};try{var $q=o.conn.getAllResponseHeaders();var $r=$q.split("\n");for(var i=0;i<$r.length;i++){var $s=$r[i].indexOf(":");if($s!=-1){$p[$r[i].substring(0,$s)]=$r[i].substring($s+2);}}}catch(e){}$a.tId=o.tId;$a.status=(o.conn.status==1223)?204:o.conn.status;$a.statusText=(o.conn.status==1223)?"No Content":o.conn.statusText;$a.getResponseHeader=$p;$a.getAllResponseHeaders=$q;$a.responseText=o.conn.responseText;$a.responseXML=o.conn.responseXML;if(typeof $o!==undefined){$a.argument=$o;}return $a;},createExceptionObject:function($e,$o,$l){var $t=0;var $u="communication failure";var $v=-1;var $w="transaction aborted";var $a={};$a.tId=$e;if($l){$a.status=$v;$a.statusText=$w;}else{$a.status=$t;$a.statusText=$u;}if($o){$a.argument=$o;}return $a;},initHeader:function($x,$y,$z){var $p=($z)?this._default_headers:this._http_headers;$p[$x]=$y;if($z){this._has_default_headers=!0;}else{this._has_http_headers=!0;}},setHeader:function(o){if(this._has_default_headers){for(var $j in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,$j)){o.conn.setRequestHeader($j,this._default_headers[$j]);}}}if(this._has_http_headers){for(var $j in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,$j)){o.conn.setRequestHeader($j,this._http_headers[$j]);}}delete this._http_headers;this._http_headers={};this._has_http_headers=!1;}},resetDefaultHeaders:function(){delete this._default_headers;this._default_headers={};this._has_default_headers=!1;},setForm:function($A,$B,$C){this.resetFormState();var $D;if(typeof $A=="string"){$D=(document.getElementById($A)||document.forms[$A]);}else{if(typeof $A=="object"){$D=$A;}else{return;}}if($B){var io=this.createFrame($C?$C:null);this._isFormSubmit=!0;this._isFileUpload=!0;this._formNode=$D;return;}var $E,$F,$G,$H;var $I=!1;for(var i=0;i<$D.elements.length;i++){$E=$D.elements[i];$H=$D.elements[i].disabled;$F=$D.elements[i].name;$G=$D.elements[i].value;if(!$H&&$F){switch($E.type){case "select-one":case "select-multiple":for(var j=0;j<$E.options.length;j++){if($E.options[j].selected){if(window.ActiveXObject){this._sFormData+=encodeURIComponent($F)+"="+encodeURIComponent($E.options[j].attributes["value"].specified?$E.options[j].value:$E.options[j].text)+"&";}else{this._sFormData+=encodeURIComponent($F)+"="+encodeURIComponent($E.options[j].hasAttribute("value")?$E.options[j].value:$E.options[j].text)+"&";}}}break;case "radio":case "checkbox":if($E.checked){this._sFormData+=encodeURIComponent($F)+"="+encodeURIComponent($G)+"&";}break;case "file":case undefined:case "reset":case "button":break;case "submit":if($I===!1){if(this._hasSubmitListener&&this._submitElementValue){this._sFormData+=this._submitElementValue+"&";}else{this._sFormData+=encodeURIComponent($F)+"="+encodeURIComponent($G)+"&";}$I=!0;}break;default:this._sFormData+=encodeURIComponent($F)+"="+encodeURIComponent($G)+"&";}}}this._isFormSubmit=!0;this._sFormData=this._sFormData.substr(0,this._sFormData.length-1);this.initHeader("Content-Type",this._default_form_header);return this._sFormData;},resetFormState:function(){this._isFormSubmit=!1;this._isFileUpload=!1;this._formNode=null;this._sFormData="";},createFrame:function($C){var $J="yuiIO"+this._transaction_id;var io;if(window.ActiveXObject){io=document.createElement("<iframe id=\""+$J+"\" name=\""+$J+"\" />");if(typeof $C=="boolean"){io.src="javascript:false";}else{if(typeof secureURI=="string"){io.src=$C;}}}else{io=document.createElement("iframe");io.id=$J;io.name=$J;}io.style.position="absolute";io.style.top="-1000px";io.style.left="-1000px";document.body.appendChild(io);},appendPostData:function($i){var $K=[];var $L=$i.split("&");for(var i=0;i<$L.length;i++){var $s=$L[i].indexOf("=");if($s!=-1){$K[i]=document.createElement("input");$K[i].type="hidden";$K[i].name=$L[i].substring(0,$s);$K[i].value=$L[i].substring($s+1);this._formNode.appendChild($K[i]);}}return $K;},uploadFile:function(o,$h,$g,$i){var $J="yuiIO"+o.tId;var $M="multipart/form-data";var io=document.getElementById($J);var $k=this;var $N={action:this._formNode.getAttribute("action"),method:this._formNode.getAttribute("method"),target:this._formNode.getAttribute("target")};this._formNode.setAttribute("action",$g);this._formNode.setAttribute("method","POST");this._formNode.setAttribute("target",$J);if(this._formNode.encoding){this._formNode.setAttribute("encoding",$M);}else{this._formNode.setAttribute("enctype",$M);}if($i){var $O=this.appendPostData($i);}this._formNode.submit();this.startEvent.fire(o);if(o.startEvent){o.startEvent.fire(o);}if($h&&$h.timeout){this._timeOut[o.tId]=window.setTimeout(function(){$k.abort(o,$h,!0);},$h.timeout);}if($O&&$O.length>0){for(var i=0;i<$O.length;i++){this._formNode.removeChild($O[i]);}}for(var $j in $N){if(YAHOO.lang.hasOwnProperty($N,$j)){if($N[$j]){this._formNode.setAttribute($j,$N[$j]);}else{this._formNode.removeAttribute($j);}}}this.resetFormState();var $P=function(){if($h&&$h.timeout){window.clearTimeout($k._timeOut[o.tId]);delete $k._timeOut[o.tId];}$k.completeEvent.fire(o);if(o.completeEvent){o.completeEvent.fire(o);}var $a={};$a.tId=o.tId;$a.argument=$h.argument;try{$a.responseText=io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:io.contentWindow.document.documentElement.textContent;$a.responseXML=io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;}catch(e){}if($h&&$h.upload){if(!$h.scope){$h.upload($a);}else{$h.upload.apply($h.scope,[$a]);}}$k.uploadEvent.fire($a);if(o.uploadEvent){o.uploadEvent.fire($a);}YAHOO.util.Event.removeListener(io,"load",$P);setTimeout(function(){document.body.removeChild(io);$k.releaseObject(o);},100);}
YAHOO.util.Event.addListener(io,"load",$P);},abort:function(o,$h,$Q){var $R;if(o.conn){if(this.isCallInProgress(o)){o.conn.abort();window.clearInterval(this._poll[o.tId]);delete this._poll[o.tId];if($Q){window.clearTimeout(this._timeOut[o.tId]);delete this._timeOut[o.tId];}$R=!0;}}else{if(o.isUpload===!0){var $J="yuiIO"+o.tId;var io=document.getElementById($J);if(io){YAHOO.util.Event.removeListener(io,"load",uploadCallback);document.body.removeChild(io);if($Q){window.clearTimeout(this._timeOut[o.tId]);delete this._timeOut[o.tId];}$R=!0;}}else{$R=!1;}}if($R===!0){this.abortEvent.fire(o);if(o.abortEvent){o.abortEvent.fire(o);}this.handleTransactionResponse(o,$h,!0);}return $R;},isCallInProgress:function(o){if(o&&o.conn){return o.conn.readyState!==4&&o.conn.readyState!==0;}else{if(o&&o.isUpload===!0){var $J="yuiIO"+o.tId;return document.getElementById($J)?!0:!1;}else{return!1;}}},releaseObject:function(o){if(o.conn){o.conn=null;}o=null;}};YAHOO.register("connection",YAHOO.util.Connect,{version:"2.3.1",build:"541"});